text(prune.model)
prune.model <- prune.misclass(tree.model,best = opt.size)
plot(prune.model)
text(prune.model)
par(mfrow=c(1,2))
prune.model <- prune.misclass(tree.model,k = opt.alpha)
plot(prune.model)
text(prune.model)
prune.model <- prune.misclass(tree.model,best = opt.size)
plot(prune.model)
text(prune.model)
#data sets
require(ISLR)
set.seed(123)
idx.train = sample.int(nrow(OJ),size = 800)
train.set = OJ[idx.train,]
test.set = OJ[-idx.train,]
#tree
require(tree)
tree.model <- tree(Purchase~., data = OJ)
summary(tree.model)
#c)
tree.model
#d)
plot(tree.model)
text(tree.model)
#e)
pred.class <- predict(tree.model,newdata = test.set,type="class")
cf = table(test.set$Purchase,pred.class)
addmargins(cf)
#f)
tree.cv = cv.tree(tree.model,FUN = prune.misclass,K=10)
opt.alpha = tree.cv$k[which.min(tree.cv$dev)]
opt.alpha
opt.size = tree.cv$size[which.min(tree.cv$dev)]
opt.size
opt.tree = prune.tree(tree.model,method = "misclass", k = opt.alpha)
plot(opt.tree)
text(opt.tree)
tree.cv
#g)
par(mfrow=c(1,1))
plot(tree.cv$size,tree.cv$dev)
grid()
#h)
#i)
par(mfrow=c(1,2))
prune.model <- prune.misclass(tree.model,k = opt.alpha)
plot(prune.model)
text(prune.model)
prune.model <- prune.misclass(tree.model,best = opt.size)
plot(prune.model)
text(prune.model)
require(ISLR)
set.seed(123)
idx.train = sample.int(nrow(OJ),size = 800)
train.set = OJ[idx.train,]
test.set = OJ[-idx.train,]
require(tree)
tree.model <- tree(Purchase~., data = OJ)
summary(tree.model)
tree.model
plot(tree.model)
text(tree.model)
pred.class <- predict(tree.model,newdata = test.set,type="class")
cf = table(test.set$Purchase,pred.class)
addmargins(cf)
tree.cv = cv.tree(tree.model,FUN = prune.misclass,K=10)
opt.alpha = tree.cv$k[which.min(tree.cv$dev)]
opt.alpha
tree.cv
require(ISLR)
set.seed(123)
idx.train = sample.int(nrow(OJ),size = 800)
train.set = OJ[idx.train,]
test.set = OJ[-idx.train,]
require(tree)
tree.model <- tree(Purchase~., data = OJ)
tree.model
summary(tree.model)
plot(tree.model)
text(tree.model)
pred.class <- predict(tree.model,newdata = test.set,type="class")
cf = table(test.set$Purchase,pred.class)
addmargins(cf)
tree.cv = cv.tree(tree.model,FUN = prune.misclass,K=5)
opt.alpha = tree.cv$k[which.min(tree.cv$dev)]
opt.alpha
opt.size = tree.cv$size[which.min(tree.cv$dev)]
opt.size
opt.tree = prune.tree(tree.model,method = "misclass", k = opt.alpha)
plot(opt.tree)
text(opt.tree)
tree.cv
require(ISLR)
set.seed(123)
idx.train = sample.int(nrow(OJ),size = 800)
train.set = OJ[idx.train,]
test.set = OJ[-idx.train,]
require(tree)
tree.model <- tree(Purchase~., data = train.set)
summary(tree.model)
tree.model
plot(tree.model)
text(tree.model)
pred.class <- predict(tree.model,newdata = test.set,type="class")
cf = table(test.set$Purchase,pred.class)
addmargins(cf)
tree.cv = cv.tree(tree.model,FUN = prune.misclass,K=5)
opt.alpha = tree.cv$k[which.min(tree.cv$dev)]
opt.alpha
opt.size = tree.cv$size[which.min(tree.cv$dev)]
opt.size
opt.tree = prune.tree(tree.model,method = "misclass", k = opt.alpha)
plot(opt.tree)
text(opt.tree)
tree.cv
par(mfrow=c(1,1))
plot(tree.cv$size,tree.cv$dev)
grid()
par(mfrow=c(1,2))
prune.model <- prune.misclass(tree.model,k = opt.alpha)
plot(prune.model)
text(prune.model)
prune.model <- prune.misclass(tree.model,best = opt.size)
plot(prune.model)
text(prune.model)
#data sets
require(ISLR)
set.seed(123)
idx.train = sample.int(nrow(OJ),size = 800)
train.set = OJ[idx.train,]
test.set = OJ[-idx.train,]
#tree
require(tree)
tree.model <- tree(Purchase~., data = train.set)
summary(tree.model)
#c)
tree.model
#d)
plot(tree.model)
text(tree.model)
#e)
pred.class <- predict(tree.model,newdata = test.set,type="class")
cf = table(test.set$Purchase,pred.class)
addmargins(cf)
#f)
tree.cv = cv.tree(tree.model,FUN = prune.misclass,K=5)
opt.alpha = tree.cv$k[which.min(tree.cv$dev)]
opt.alpha
opt.size = tree.cv$size[which.min(tree.cv$dev)]
opt.size
opt.tree = prune.tree(tree.model,method = "misclass", k = opt.alpha)
plot(opt.tree)
text(opt.tree)
tree.cv
#g)
par(mfrow=c(1,1))
plot(tree.cv$size,tree.cv$dev)
grid()
#h)
#i)
par(mfrow=c(1,2))
prune.model <- prune.misclass(tree.model,k = opt.alpha)
plot(prune.model)
text(prune.model)
prune.model <- prune.misclass(tree.model,best = opt.size)
plot(prune.model)
text(prune.model)
cf
#data sets
require(ISLR)
set.seed(123)
idx.train = sample.int(nrow(OJ),size = 800)
train.set = OJ[idx.train,]
test.set = OJ[-idx.train,]
#tree
require(tree)
tree.model <- tree(Purchase~., data = train.set)
summary(tree.model)
#c)
tree.model
#d)
plot(tree.model)
text(tree.model)
#e)
pred.class <- predict(tree.model,newdata = test.set,type="class")
cf = table(test.set$Purchase,pred.class)
addmargins(cf)
#f)
tree.cv = cv.tree(tree.model,FUN = prune.misclass,K=5)
opt.alpha = tree.cv$k[which.min(tree.cv$dev)]
opt.alpha
opt.size = tree.cv$size[which.min(tree.cv$dev)]
opt.size
opt.tree = prune.tree(tree.model,method = "misclass", k = opt.alpha)
plot(opt.tree)
text(opt.tree)
tree.cv
#g)
par(mfrow=c(1,1))
plot(tree.cv$size,tree.cv$dev)
grid()
#h)
#i)
par(mfrow=c(1,2))
prune.model <- prune.misclass(tree.model,k = opt.alpha)
plot(prune.model)
text(prune.model)
prune.model <- prune.misclass(tree.model,best = opt.size)
plot(prune.model)
text(prune.model)
ts
require(ISLR)
set.seed(123)
idx.train = sample.int(nrow(OJ),size = 800)
train.set = OJ[idx.train,]
test.set = OJ[-idx.train,]
#tree
require(tree)
tree.model <- tree(Purchase~., data = OJ)
summary(tree.model)
#c)
tree.model
#d)
plot(tree.model)
text(tree.model)
#e)
pred.class <- predict(tree.model,newdata = test.set,type="class")
cf = table(test.set$Purchase,pred.class)
addmargins(cf)
#f)
tree.cv = cv.tree(tree.model,FUN = prune.misclass,K=5)
opt.alpha = tree.cv$k[which.min(tree.cv$dev)]
opt.alpha
opt.size = tree.cv$size[which.min(tree.cv$dev)]
opt.size
opt.tree = prune.tree(tree.model,method = "misclass", k = opt.alpha)
plot(opt.tree)
text(opt.tree)
tree.cv
#g)
par(mfrow=c(1,1))
plot(tree.cv$size,tree.cv$dev)
grid()
#h)
#i)
par(mfrow=c(1,2))
prune.model <- prune.misclass(tree.model,k = opt.alpha)
plot(prune.model)
text(prune.model)
prune.model <- prune.misclass(tree.model,best = opt.size)
plot(prune.model)
text(prune.model)
tree.model <- tree(Purchase~., data = train.set)
#data sets
require(ISLR)
set.seed(123)
idx.train = sample.int(nrow(OJ),size = 800)
train.set = OJ[idx.train,]
test.set = OJ[-idx.train,]
#tree
require(tree)
tree.model <- tree(Purchase~., data = train.set)
summary(tree.model)
#c)
tree.model
#d)
plot(tree.model)
text(tree.model)
#e)
pred.class <- predict(tree.model,newdata = test.set,type="class")
cf = table(test.set$Purchase,pred.class)
addmargins(cf)
#f)
tree.cv = cv.tree(tree.model,FUN = prune.misclass,K=5)
opt.alpha = tree.cv$k[which.min(tree.cv$dev)]
opt.alpha
opt.size = tree.cv$size[which.min(tree.cv$dev)]
opt.size
opt.tree = prune.tree(tree.model,method = "misclass", k = opt.alpha)
plot(opt.tree)
text(opt.tree)
tree.cv
#g)
par(mfrow=c(1,1))
plot(tree.cv$size,tree.cv$dev)
grid()
#h)
#i)
par(mfrow=c(1,2))
prune.model <- prune.misclass(tree.model,k = opt.alpha)
plot(prune.model)
text(prune.model)
prune.model <- prune.misclass(tree.model,best = opt.size)
plot(prune.model)
text(prune.model)
#data sets
require(ISLR)
set.seed(123)
idx.train = sample.int(nrow(OJ),size = 800)
train.set = OJ[idx.train,]
test.set = OJ[-idx.train,]
#tree
require(tree)
tree.model <- tree(Purchase~., data = train.set)
summary(tree.model)
#c)
tree.model
#d)
plot(tree.model)
text(tree.model)
#e)
pred.class <- predict(tree.model,newdata = test.set,type="class")
cf = table(test.set$Purchase,pred.class)
addmargins(cf)
#f)
tree.cv = cv.tree(tree.model,FUN = prune.misclass,K=10)
opt.alpha = tree.cv$k[which.min(tree.cv$dev)]
opt.alpha
opt.size = tree.cv$size[which.min(tree.cv$dev)]
opt.size
opt.tree = prune.tree(tree.model,method = "misclass", k = opt.alpha)
plot(opt.tree)
text(opt.tree)
tree.cv
#g)
par(mfrow=c(1,1))
plot(tree.cv$size,tree.cv$dev)
grid()
#h)
#i)
par(mfrow=c(1,2))
prune.model <- prune.misclass(tree.model,k = opt.alpha)
plot(prune.model)
text(prune.model)
prune.model <- prune.misclass(tree.model,best = opt.size)
plot(prune.model)
text(prune.model)
#9.4
#data sets
require(ISLR)
set.seed(123)
idx.train = sample.int(nrow(OJ),size = 800)
train.set = OJ[idx.train,]
test.set = OJ[-idx.train,]
#tree
require(tree)
tree.model <- tree(Purchase~., data = train.set)
summary(tree.model)
#c)
tree.model
#d)
plot(tree.model)
text(tree.model)
#e)
pred.class <- predict(tree.model,newdata = test.set,type="class")
cf = table(test.set$Purchase,pred.class)
addmargins(cf)
#f)
tree.cv = cv.tree(tree.model,FUN = prune.misclass,K=6)
opt.alpha = tree.cv$k[which.min(tree.cv$dev)]
opt.alpha
opt.size = tree.cv$size[which.min(tree.cv$dev)]
opt.size
opt.tree = prune.tree(tree.model,method = "misclass", k = opt.alpha)
plot(opt.tree)
text(opt.tree)
tree.cv
#g)
par(mfrow=c(1,1))
plot(tree.cv$size,tree.cv$dev)
grid()
#h)
#i)
par(mfrow=c(1,2))
prune.model <- prune.misclass(tree.model,k = opt.alpha)
plot(prune.model)
text(prune.model)
prune.model <- prune.misclass(tree.model,best = opt.size)
plot(prune.model)
text(prune.model)
#9.4
#data sets
require(ISLR)
set.seed(123)
idx.train = sample.int(nrow(OJ),size = 800)
train.set = OJ[idx.train,]
test.set = OJ[-idx.train,]
#tree
require(tree)
tree.model <- tree(Purchase~., data = train.set)
summary(tree.model)
#c)
tree.model
#d)
plot(tree.model)
text(tree.model)
#e)
pred.class <- predict(tree.model,newdata = test.set,type="class")
cf = table(test.set$Purchase,pred.class)
addmargins(cf)
#f)
tree.cv = cv.tree(tree.model,FUN = prune.misclass,K=5)
opt.alpha = tree.cv$k[which.min(tree.cv$dev)]
opt.alpha
opt.size = tree.cv$size[which.min(tree.cv$dev)]
opt.size
opt.tree = prune.tree(tree.model,method = "misclass", k = opt.alpha)
plot(opt.tree)
text(opt.tree)
tree.cv
#g)
par(mfrow=c(1,1))
plot(tree.cv$size,tree.cv$dev)
grid()
#h)
#i)
par(mfrow=c(1,2))
prune.model <- prune.misclass(tree.model,k = opt.alpha)
plot(prune.model)
text(prune.model)
prune.model <- prune.misclass(tree.model,best = opt.size)
plot(prune.model)
text(prune.model)
#data sets
require(ISLR)
set.seed(123)
idx.train = sample.int(nrow(OJ),size = 800)
train.set = OJ[idx.train,]
test.set = OJ[-idx.train,]
#tree
require(tree)
tree.model <- tree(Purchase~., data = train.set)
summary(tree.model)
#c)
tree.model
#d)
plot(tree.model)
text(tree.model)
#e)
pred.class <- predict(tree.model,newdata = test.set,type="class")
cf = table(test.set$Purchase,pred.class)
addmargins(cf)
#f)
tree.cv = cv.tree(tree.model,FUN = prune.misclass,K=5)
opt.alpha = tree.cv$k[which.min(tree.cv$dev)]
opt.alpha
opt.size = tree.cv$size[which.min(tree.cv$dev)]
opt.size
opt.tree = prune.tree(tree.model,method = "misclass", k = opt.alpha)
plot(opt.tree)
text(opt.tree)
tree.cv
#g)
par(mfrow=c(1,1))
plot(tree.cv$size,tree.cv$dev)
grid()
#h)
#i)
par(mfrow=c(1,2))
prune.model <- prune.misclass(tree.model,k = opt.alpha)
plot(prune.model)
text(prune.model)
prune.model <- prune.misclass(tree.model,best = opt.size)
plot(prune.model)
text(prune.model)
summary(tree.model)
summary(prune.model)
pred.classnew <- predict(tree.model,newdata = test.set,type="class")
cfnew = table(test.set$Purchase,pred.class)
addmargins(cfnew)
pred.classnewprune <- predict(tree.model,newdata = test.set,type="class")
cfnewprune = table(test.set$Purchase,pred.class)
addmargins(cfnewprune)
pred.classnewprune <- predict(prune.model),newdata = test.set,type="class")
cfnewprune = table(test.set$Purchase,pred.class)
addmargins(cfnewprune)
pred.classnewprune <- predict(prune.model,newdata = test.set,type="class")
cfnewprune = table(test.set$Purchase,pred.class)
addmargins(cfnewprune)
pred.classnew <- predict(tree.model,newdata = test.set,type="class")
cfnew = table(test.set$Purchase,pred.class)
addmargins(cfnew)
48/270
pred.classnewprune <- predict(prune.model,newdata = test.set,type="class")
cfnewprune = table(test.set$Purchase,pred.class)
addmargins(cfnewprune)
summary(tree.model)
summary(prune.model)
summary(tree.model)
summary(prune.model)
summary(tree.model)
summary(prune.model)
cols.dont.want = c("name")
data2 <- Auto
data2 <- data2[, ! names(data2) %in% cols.dont.want, drop = F]
library(ISLR)
library(tree)
cols.dont.want = c("name")
data2 <- Auto
data2 <- data2[, ! names(data2) %in% cols.dont.want, drop = F]
reg.tree.model <- tree(mpg~.,data = data2)
plot(reg.tree.model)
text(reg.tree.model)
prune.reg.tree <- cv.tree(reg.tree.model,K=5)
opt.alpha.reg <- prune.reg.tree$k[which.min(prune.reg.tree$dev)]
setwd("H:/Python_Db")
data <- read.table("urs.txt",sep=";",head=TRUE)
data
str(data)
hist(data)
